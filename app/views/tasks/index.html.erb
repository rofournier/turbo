<div class="min-h-screen bg-gray-100 py-10">
  <div class="container mx-auto px-4 max-w-5xl">
    <h1 class="text-3xl font-bold text-indigo-700 mb-6 text-center">Weekly Task Summary</h1>
    
    <%= render "tasks/item/stats", tasks: @all_tasks%>
    
    <%= render "tasks/item/summary", completed_tasks: @completed_tasks, running_tasks: @running_tasks %>

    <div class="mt-10 bg-white rounded-lg shadow-md p-6">
      <h2 class="text-2xl font-semibold text-indigo-600 mb-6 text-center">Analytics</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
       <div id="distro_<%= current_user.id%>" class="bg-gray-50 p-4 rounded-lg shadow-sm">
          <h3 class="text-lg font-medium text-gray-800 mb-4">Task Completion Distribution</h3>
          <%= column_chart @all_tasks.group(:completed).count,
              colors: ["#F59E0B"],
              library: {
                scales: { y: { beginAtZero: true } },
                xAxes: [{
                  ticks: {
                    callback: 'function(value) { return value ? "Completed" : "Incomplete"; }'
                  }
                }]
              } %>
        </div>

        <div class="bg-gray-50 p-4 rounded-lg shadow-sm">
          <h3 class="text-lg font-medium text-gray-800 mb-4">Time Distribution</h3>
          <%= pie_chart @all_tasks.group(:name).sum(:time_spent), 
                        donut: true, 
                        colors: ["#4F46E5", "#10B981", "#F59E0B", "#EF4444", "#8B5CF6", "#EC4899"], 
                        library: { 
                          legend: { position: 'bottom' },
                          title: { text: 'Time Spent by Task', x: -20 } 
                        } %>
        </div>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div class="bg-gray-50 p-4 rounded-lg shadow-sm">
          <h3 class="text-lg font-medium text-gray-800 mb-4">Weekly Progress</h3>
          <%= line_chart @all_tasks.group_by_day(:created_at, last: 7).sum(:time_spent),
                        colors: ["#10B981"],
                        library: {
                          scales: { y: { beginAtZero: true } }
                        } %>
        </div>

        <div class="bg-gray-50 p-4 rounded-lg shadow-sm">
          <h3 class="text-lg font-medium text-gray-800 mb-4">Task Comparison</h3>
          <%= bar_chart @all_tasks.group(:name).sum(:time_spent), 
                        colors: ["#4F46E5"],
                        library: { 
                          scales: { y: { beginAtZero: true } } 
                        } %>
        </div>
      </div>
    </div>
  </div>
</div>
